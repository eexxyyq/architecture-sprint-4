# Анализ, идентификация проблем и решений, планирование
В данном решение принято за известное и допустимое:
- MES система не имеет проблем с оптимизацией SQL запросов
- MES система не имеет узких мест в кодовой базе, которые необходимо оптимизировать
- MES система допускает выделение и вынос отдельных ее моделей в микросервисы
## Существующие и потенциальные проблемные места проблемы
1. **Задержка выполнения заказов:** Высокая нагрузка на систему, задержки в процессе обработки заказов как со стороны пользователей, так и через API.
2. **Высокая задержка при загрузке MES:** Операторы сталкиваются с трудностями при получении информации о заказах.
3. **Низкая эффективность процесса тестирования:**
   - Недостаточная численность QA.
   - Отсутствие автоматизированных тестов и нагрузочного тестирования.
   - Неэффективное unit-тестирование.
4. **Отсутствие реакции на возникающие технические проблемы в процессе релизов и эксплуатации:**
   - Отсутствие специалистов SRE.
   - Нехватка наблюдаемости системы, нет метрик для анализа проблем.
5. **Единая точка отказа в базе данных:** Все сервисы работают с одними и теми же базами данных, что увеличивает нагрузку и риск отказов.
6. **Невозможность масштабирования сервисов:** Все сервисы работают на одном инстансе, что ограничивает возможность масштабирования под увеличивающуюся нагрузку.

---

## Предложенные инициативы:

### 1. Внедрение системы мониторинга и трейсинга
**Цель:** Повышение наблюдаемости системы для своевременного выявления и устранения проблем.
- Внедрение Prometheus для сбора метрик с сервисов и интеграция с Grafana для визуализации данных.
- Использование Jaeger для распределенного трейсинга и отслеживания пути обработки заказов в системе.
- Разработка алертов для критических метрик, чтобы оперативно реагировать на возможные проблемы.

### 2. Микросервисная архитектура
**Цель:** Повышение масштабируемости системы.
- **Решение:** Разделение функционала, вынос модуля для отчетности и уведомлений из MES, создание микросервисов для этих процессов.
- Интеграция между MES и CRM через шлюз, что позволит разделить нагрузку и повысить производительность.
- Применение кэширования с использованием Redis для снижения нагрузки на базу данных при частых запросах.

### 3. Автоматизированное тестирование
**Цель:** Сокращение времени релизов и повышение качества разработки.
- Внедрение автоматизированных тестов для регрессионного тестирования типовых кейсов.
- Проведение нагрузочных тестов на preprod окружении, чтобы заранее выявлять узкие места системы и не допускать проблем при увеличении нагрузки.

### 4. Оптимизация работы с базами данных
**Цель:** Уменьшение нагрузки на базы данных и повышение их отказоустойчивости.
- Разделение баз данных на реплики для чтения и записи, чтобы снизить нагрузку на один инстанс и улучшить производительность.
- Использование кэширования Redis для чтения данных, что позволит снизить нагрузку на базу данных и ускорить обработку запросов.

### 5. Системы CI/CD для автоматизации процессов развертывания
**Цель:** Ускорение развертывания новых версий и улучшение гибкости.
- Настройка CI/CD для автоматического деплоя в dev и preprod окружения, что позволит безболезненно проводить релизы и ускорит процесс разработки.
- Создание процесса для быстрого выпуска релизов на prod-окружение с минимальными задержками.

### 6. Масштабирование инфраструктуры
**Цель:** Подготовка системы к увеличению нагрузки.
- Использование кластеризации сервисов (например, Kubernetes для управления контейнерами и Istio для микросервисного взаимодействия).

---

## План работ на первые 3 месяца:

1. **Первоначальный этап (1 месяц) — Подготовка к выносу модулей из MES:**
   - Исследование и анализ текущих процессов в MES и CRM.
   - Определение модуля для вынесения из MES (отчетности, уведомлений).
   - Оценка необходимых изменений в архитектуре, создание плана внедрения микросервисов.

2. **Разработка микросервисов и модификация CRM (2-й месяц):**
   - Разработка и внедрение микросервисов для отчетности и уведомлений.
   - Модификация CRM для интеграции с MES через шлюз.
   - Настройка кэширования Redis для снижения нагрузки на базу данных.

3. **Интеграция и тестирование (3-й месяц):**
   - Интеграция всех компонентов системы (CRM, MES, микросервисы).
   - Нагрузочное тестирование и проверка системы на устойчивость к увеличению нагрузки.
   - Проведение функциональных тестов.

---

## Кадровые перестановки и расширение команды:

### 1. Найм дополнительных специалистов:
- **DevOps:** Для ускорения развертывания и управления инфраструктурой потребуется как минимум второй DevOps-инженер.
- **QA/AQA:** Учитывая важность автоматизации тестирования и увеличения скорости поставки, стоит нанять дополнительного инженера по автоматизированному тестированию.
- **SRE:** Для обеспечения отказоустойчивости и мониторинга системы, особенно при внедрении микросервисной архитектуры, понадобится специалист SRE.
- **DBA (Database Administrator):** С учетом важности работы с базами данных, потребуется специалист по базам данных для оптимизации и кластеризации БД.

### 2. Перераспределение задач в текущей команде:
- **QA:** Перевод текущего QA-инженера на роль AQA, с переходом на автоматизацию тестов. При этом следует нанять нового QA-инженера для ручного тестирования.
- **Разработчики:** В связи с выносом функционала из MES и интеграцией с другими системами, нужно перераспределить задачи между текущими разработчиками (Java, C#) для ускоренной разработки необходимых сервисов.